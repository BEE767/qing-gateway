import{r as e,K as t,j as n,_ as o,T as r,d as i,c as a,b as s,z as l,A as c}from"./index.js";var u={adjustX:1,adjustY:1},f=[0,0],p={topLeft:{points:["bl","tl"],overflow:u,offset:[0,-4],targetOffset:f},topCenter:{points:["bc","tc"],overflow:u,offset:[0,-4],targetOffset:f},topRight:{points:["br","tr"],overflow:u,offset:[0,-4],targetOffset:f},bottomLeft:{points:["tl","bl"],overflow:u,offset:[0,4],targetOffset:f},bottomCenter:{points:["tc","bc"],overflow:u,offset:[0,4],targetOffset:f},bottomRight:{points:["tr","br"],overflow:u,offset:[0,4],targetOffset:f}},v=t.ESC,d=t.TAB;function g(t){var n=t.visible,o=t.setTriggerVisible,r=t.triggerRef,i=t.menuRef,a=t.onVisibleChange,s=function e(){var t,i,s,l;n&&r.current&&(null===(t=r.current)||void 0===t||null===(i=t.triggerRef)||void 0===i||null===(s=i.current)||void 0===s||null===(l=s.focus)||void 0===l||l.call(s),o(!1),"function"==typeof a&&a(!1))},l=function e(t){switch(t.keyCode){case v:case d:s()}},c=function e(){var t,n;null===(t=i.current)||void 0===t||null===(n=t.focus)||void 0===n||n.call(t)},u;return e.exports.useEffect((function(){return n?(setTimeout((function(){c(),window.addEventListener("keydown",l)}),100),function(){window.removeEventListener("keydown",l)}):function(){return null}}),[n]),{returnFocus:function e(){n&&setTimeout((function(){var e,t,n,o;null===(e=r.current)||void 0===e||null===(t=e.triggerRef)||void 0===t||null===(n=t.current)||void 0===n||null===(o=n.focus)||void 0===o||o.call(n)}),100)}}}var m=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger"];function b(t,u){var f=t.arrow,v=void 0!==f&&f,d=t.prefixCls,b=void 0===d?"rc-dropdown":d,w=t.transitionName,C=t.animation,h=t.align,x=t.placement,y=void 0===x?"bottomLeft":x,R=t.placements,A=void 0===R?p:R,N=t.getPopupContainer,O=t.showAction,E=t.hideAction,T=t.overlayClassName,k=t.overlayStyle,V=t.visible,P=t.trigger,j=void 0===P?["hover"]:P,L=n(t,m),S=e.exports.useState(),F=o(S,2),M=F[0],W=F[1],z="visible"in t?V:M,B=e.exports.useRef(null);e.exports.useImperativeHandle(u,(function(){return B.current}));var D=e.exports.useRef(null),H="".concat(b,"-menu"),I,K=g({visible:z,setTriggerVisible:W,triggerRef:B,menuRef:D,onVisibleChange:t.onVisibleChange}).returnFocus,X=function e(){var n=t.overlay,o;return o="function"==typeof n?n():n},Y=function e(n){var o=t.onOverlayClick,r=X().props;W(!1),o&&o(n),r.onClick&&r.onClick(n),K()},_=function e(n){var o=t.onVisibleChange;W(n),"function"==typeof o&&o(n)},q=function t(){var n,o=X(),r=l(D,o.ref),i=(s(n={prefixCls:H},"data-dropdown-inject",!0),s(n,"onClick",Y),s(n,"ref",c(o)?r:void 0),n);return"string"==typeof o.type&&(delete i.prefixCls,delete i["data-dropdown-inject"]),e.exports.createElement(e.exports.Fragment,null,v&&e.exports.createElement("div",{className:"".concat(b,"-arrow")}),e.exports.cloneElement(o,i))},G=function e(){var n;return"function"==typeof t.overlay?q:q()},J=function e(){var n=t.minOverlayWidthMatchTrigger,o=t.alignPoint;return"minOverlayWidthMatchTrigger"in t?n:!o},Q=function e(){var n=t.openClassName;return void 0!==n?n:"".concat(b,"-open")},U=function n(){var o=t.children,r=o.props?o.props:{},i=a(r.className,Q());return z&&o?e.exports.cloneElement(o,{className:i}):o},Z=E;return Z||-1===j.indexOf("contextMenu")||(Z=["click"]),e.exports.createElement(r,i(i({builtinPlacements:A},L),{},{prefixCls:b,ref:B,popupClassName:a(T,s({},"".concat(b,"-show-arrow"),v)),popupStyle:k,action:j,showAction:O,hideAction:Z||[],popupPlacement:y,popupAlign:h,popupTransitionName:w,popupAnimation:C,popupVisible:z,stretch:J()?"minWidth":"",popup:G(),onPopupVisibleChange:_,getPopupContainer:N}),U())}var w=e.exports.forwardRef(b);export{w as D};
